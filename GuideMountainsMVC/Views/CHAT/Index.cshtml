@* @{
    ViewData["Title"] = "Chat";
}

    <link rel="stylesheet" href="/css/chat.css" asp-append-version="true" />


<div class="chat-wrapper">
    <div class="chat-window">
        <div class="chat-header">
            <h2><i class="bi bi-chat-dots-fill"></i> AI Chat</h2>
        </div>
        <div class="chat-messages" id="chat-log">
            <!-- Messages will appear here -->
        </div>
        <div class="chat-input-wrapper">
            <input type="text" id="chat-input" placeholder="Type your message..." autocomplete="off" />
            <button id="send-btn"><i class="bi bi-send-fill"></i></button>
        </div>
    </div>
</div>

@section Scripts {
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(function () {
            function appendMessage(sender, message) {
                const bubble = $('<div class="message ' + sender + '"></div>').text(message);
                $("#chat-log").append(bubble);
                $("#chat-log").scrollTop($("#chat-log")[0].scrollHeight);
            }

            $("#send-btn").click(function () {
                const msg = $("#chat-input").val();
                if ($.trim(msg) === "") return;
                appendMessage("user", msg);
                $("#chat-input").val("");

                $.ajax({
                    url: '@Url.Action("SendMessage", "Chat")',
                    type: 'POST',
                    data: { userPrompt: msg },
                    success: function (res) {
                        appendMessage("bot", res.answer);
                    },
                    error: function () {
                        appendMessage("bot", "⚠️ Server error.");
                    }
                });
            });

            $("#chat-input").keypress(function (e) {
                if (e.which === 13) {
                    $("#send-btn").click();
                    return false;
                }
            });
        });
    </script>
}
 *@